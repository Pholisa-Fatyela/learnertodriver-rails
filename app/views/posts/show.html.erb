<% content_for :page_title, @post.title %>
<% breadcrumb :post, @post %>

<article class="post content">

  <div class="post-header">
    <h1 class="post-title" itemprop="name headline">
      <%= @post.title %>
    </h1>
  </div>

  <div class="post-content" itemprop="articleBody">
    <%= @post.content.html_safe %>


    <div class="post-meta">
      <p class="post-date">Posted <%= time_ago_in_words(@post.created_at) %> ago</p>

        <% if @post.user == current_user -%>
        <div class="btn-group">
          <%= link_to ' Edit Post ', edit_post_path(@post), class: "button fa fa-pencil-square-o" %>
          <%= link_to ' Delete Post ', @post, method: :delete, data: { confirm: 'Are you sure?' }, class: "button fa fa-trash" %>
        </div>
        <% end %>

        <div class="btn-group pull-right">
          <%= link_to like_post_path(@post), method: :put, class: "button btn-default btn-sm" do %>
        <span class="fa fa-thumbs-up"></span>
          <%= @post.get_upvotes.size %>
        <% end %>

          <%= link_to dislike_post_path(@post), method: :put, class: "button btn-default btn-sm" do %>
        <span class="fa fa-thumbs-down"></span>
          <%= @post.get_downvotes.size %>
        <% end %>

    </div>

    </div>
  </div>

</article>

  <div class="post-meta-container">
    <div class="post-author">

      <div class="post-author-content">

          <div class="author avatar">
            <%= image_tag gravatar_url(@post.user.email, :size=> 300), alt: 'profile', class: "author avatar" %>
          </div>
          <div class="author username">
            <h4><%= link_to @post.user.username, user_path(@post.user) %></h4>
          </div>
          <div class="author bio">
            <p><%= @post.user.bio %></p>
          </div>
          <div class="author social">
            <div class="flex centered">

              <%= link_to "https://twitter.com/#{ @post.user.social_link}" do %>
                <div class="twitter icon">
                  <%= inline_svg("twitter.svg") %>
                </div>
              <% end %>

              <%= link_to "https://instagram.com/#{ @post.user.portfilo_link }" do %>
                <div class="insta icon">
                  <%= inline_svg("instagram.svg") %>
                </div>
             <% end %>

            </div>
          </div>

      </div>

    </div>
  </div>


<article class="comments content">
  <div class="comments-title-container">
    <h2 class="comments-title fleft"><%= @post.comments.count %> Comments</h2>
  </div>

  <div id="comment-section" class="comment-section">

    <% if @post.comments.any? %>
      <%= render :partial => @post.comments.includes(:user) %>
    <% else %>

    <div class="comment-header">
      <h4>Be the first to comment</h4>
    </div>

    <% end %>

    <div id="respond" class="comment-respond">
      <h4 id="reply-title" class="comment-reply-title">Leave a Reply</h4>

    <%= simple_form_for [@post, Comment.new]  do |f| %>
      <div class="field">
        <%= f.text_area :body, class: "form-control" %>
      </div>
    <br>
        <%= f.submit "Post Comment", class: "button btn-primary" %>
    <% end %>

    </div>
  </div>

</article>